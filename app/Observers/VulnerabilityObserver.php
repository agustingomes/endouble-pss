<?php

namespace App\Observers;

use App\Models\Vulnerability;

/**
 * Vulnerability Observer class.
 */
class VulnerabilityObserver
{
    /**
     * Handle the Vulnerability "updated" event.
     *
     * @param \App\Models\Vulnerability $finding
     */
    public function updated(Vulnerability $vulnerability)
    {
        // Update the related findings severity
        foreach ($vulnerability->findings()->get() as $finding) {
            $finding->severity_id = $vulnerability->severity_id;
            $finding->save();
        }
    }
}
